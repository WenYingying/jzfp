<html>
<head>
    <title>年龄指数</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta id="viewport" content="width=device-width,initial-scale=0.2, maximum-scale=1,user-scalable=no" ,="" name="viewport">
    <link rel="stylesheet" type="text/css" href="../css/common.css">
    <script type="text/javascript" src="../js/jquery-1.12.1.min.js"></script>
    <style type="text/css">
        .middle {
            padding-bottom: 0;
        }

        .Edure_info {
            width: 100%;
            display: block;
            overflow: hidden;
            border: 1px solid #e6e6e6;
            background: url(../img/alert_bg.jpg);
            font-size: 0.8rem;
        }

            .Edure_info li {
                width: 46%;
                display: inline-block;
                height: 2rem;
                line-height: 2rem;
                margin-left: 3%;
            }

                .Edure_info li span {
                    font-size: 0.7rem;
                    color: #808080;
                    line-height: 2rem;
                    margin-right: 0.5rem;
                    display: inline-block;
                }

                .Edure_info li label {
                    color: #005982;
                    line-height: 2rem;
                    display: inline-block;
                }

                .Edure_info li.li_info {
                    width: 94%;
                    border-bottom: 1px solid #e6e6e6;
                    margin: 0 auto;
                    display: block;
                }

                    .Edure_info li.li_info > div {
                        width: 32%;
                        display: inline-block;
                    }

                .Edure_info li:nth-child(2N+3) > label {
                    color: #ff7d2a;
                }

        .report_list {
            width: 100%;
            height: 6rem;
            margin: 0.5rem 0;
        }

            .report_list > dl {
                display: inline-block;
                width: 19%;
                height: 6rem;
                text-align: center;
            }

                .report_list > dl > dt.iconfont {
                    font-size: 3rem;
                    color: #b3b3b3;
                }

                .report_list > dl > dt {
                    position: relative;
                }

                    .report_list > dl > dt > span {
                        position: absolute;
                        top: 45%;
                        /* left: 40.5%; */
                        font-size: 0.7rem;
                        display: block;
                        text-align: center;
                        width: 100%;
                    }

                .report_list > dl > dd {
                    font-size: 0.8rem;
                }

                    .report_list > dl > dd > span {
                        display: block;
                        margin-top: 0.3rem;
                        font-size: 1rem;
                    }

                    .report_list > dl > dd.yituopin > span {
                        color: #005982;
                    }

                    .report_list > dl > dd.weituopin > span {
                        color: #ff7d2a;
                    }

                    .report_list > dl > dd > text {
                        margin-top: 0.3rem;
                        display: block;
                    }

        #box > .cont_box:nth-of-type(1) {
            margin-top: 1rem !important;
        }

        .Edure_info > .L_info, .Edure_info > .R_info {
            width: 47%;
            display: inline-block;
        }

            .Edure_info > .L_info li {
                width: 100%;
                text-indent: 0.8rem;
            }

        .Edure_info > h1 {
            margin-top: -0.4rem;
            z-index: 111;
            margin-left: 0.7rem;
            width: 50%;
            background-color: #fafafa;
            text-align: center;
        }

        .report_down {
            width: 100%;
            height: 3.2rem;
            margin-top: 1rem;
            border-top: 1px solid #ccc;
        }

            .report_down > h2 {
                width: 19%;
                line-height: 3.2rem;
                display: inline-block;
                overflow: hidden;
                font-size: 0.8rem;
            }

            .report_down > div {
                width: 80%;
                height: 3.2rem;
                vertical-align: top;
                display: inline-block;
            }

                .report_down > div li {
                    width: 16%;
                    height: 3.2rem;
                    text-align: center;
                    display: inline-block;
                    font-size: 0.8rem;
                }

                    .report_down > div li > div {
                        margin: 0.5rem 0;
                    }

                    .report_down > div li > span {
                        color: #005982;
                    }

        .title > a {
            height: 1.5rem;
            border-radius: 3px;
            width: 4.2rem;
            background-color: #7198ba;
            color: #fff;
            display: block;
            text-align: center;
            line-height: 1.5rem;
            font-size: 0.7rem;
            float: right;
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="cont">
        <div class="cont_box">
            <div class="cont_left">
                <div class="middle">
                    <div id="main3" style="width: 100%;height:400px;"></div>
                    <div id="citymap" style="width: 100%;height:400px;display:none;"></div>
                </div>
            </div>
            <div class="cont_right">
                <div class="middle">
                    <h1 class="title Place_name">
                        河南蒙古族自治县
                        <a href="AreaReport.html?ProvinceId=29&amp;CountyId=2452&amp;CityId=284&amp;PlaceName=" class="a_search Place_GoNext">点击进入</a>
                    </h1>
                    <div class="cont_right_pie">
                        <div class="Edure_info">
                            <ul>
                                <li class="li_info">
                                    <div>
                                        <span>贫困户数</span>
                                        <label class="palce_HouseSumCount">统计中...</label>
                                    </div>
                                    <div>
                                        <span>贫困人数</span>
                                        <label class="palce_SumCount" style="color: #005982; ">统计中...</label>
                                    </div>
                                    <div>
                                        <span>在校生人数</span>
                                        <label class="palce_InSchoolSumCount" style="color: #005982; ">统计中...</label>
                                    </div>

                                </li>
                                <li>
                                    <span>已复核人数:</span>
                                    <label class="palce_NotPovertyCount">统计中...</label>
                                </li>
                                <li>
                                    <span>未复核人数:</span>
                                    <label class="palce_PovertyCount">统计中...</label>
                                </li>
                                <li>
                                    <span>已复核比例:</span>
                                    <label class="palce_NotPovertyRebate">统计中...</label>
                                </li>
                                <li>
                                    <span>未复核比例:</span>
                                    <label class="palce_PovertyRebate">统计中...</label>
                                </li>
                            </ul>
                        </div>
                        <div class="Edure_info" style="margin-top: 1rem;overflow: initial;">
                            <h1>当前地区贫困户年龄段分布人数/比例</h1>
                            <div class="L_info">
                                <ul>
                                    <li>
                                        01 - 03岁：
                                        <span data-min="0" data-max="3">统计中...</span>
                                    </li>
                                    <li>
                                        04 - 18岁：
                                        <span data-min="4" data-max="18">统计中...</span>
                                    </li>
                                    <li>
                                        19 - 25岁：
                                        <span data-min="19" data-max="25">统计中...</span>
                                    </li>
                                    <li>
                                        26 - 59岁：
                                        <span data-min="26" data-max="59">统计中...</span>
                                    </li>
                                    <li>
                                        60岁以上 ：
                                        <span data-min="60" data-max="200">统计中...</span>
                                    </li>
                                    <li>
                                        未知年龄 ：
                                        <span id="NoAge">统计中...</span>
                                    </li>
                                </ul>
                            </div>
                            <div class="R_info">
                                <div id="AgeChart" style="width: 260px;height: 200px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="box"></div>
    </div>
    <script src="../js/Common.js"></script>
    <script src="../js/echarts.js"></script>
    <script type="text/javascript">
        $(function () {
            var placename = "";
            if (UserList.CountyId != 0) {
                placename = UserList.CountyName;
                $("#main3").hide();
                $("#citymap").css("display", "inline-block");
                LoadCityMap(UserList.CityId, UserList.CityName);
            }
            else if (UserList.CountyId == 0 && UserList.CityId != 0) {
                placename = UserList.CityName;
                $("#main3").hide();
                $("#citymap").css("display", "inline-block");
                LoadCityMap(UserList.CityId, UserList.CityName);
            }
            else {
                placename = "青海省";
                LoadMap();
            }
            LoadRegion(placename, UserList.ProvinceId, UserList.CityId, UserList.CountyId);
            GetList(UserList.CityId, UserList.CountyId);
        });

        function LoadMap() {
            var mapChart = echarts.init(document.getElementById('main3'));
            $.get('/js/qinghai.json', function (geoJson) {
                echarts.registerMap('qinghai', geoJson);
            });
            var MapData = [];
            $.post(ServiceUrl + "CityInterface/GetHandler.ashx", { ProvinceID: 29 }, function (res) {
                var json = JSON.parse(res);
                if (json.Result) {
                    $(json.Data).each(function () {
                        var CityID = this.ID;
                        var CityName = this.Name;
                        $.post(ServiceUrl + "PovertyArchivesInterface/GetHandler.ashx", { CityID: CityID }, function (res1) {
                            var cityjson = JSON.parse(res1);
                            if (cityjson.Result) {
                                var Count = 0;
                                $(cityjson.Data).each(function () {
                                    Count += parseInt(this.ID);
                                });
                                MapData.push({
                                    name: CityName,
                                    value: Count,
                                    ID: CityID
                                });
                                OverloadMap(mapChart, MapData);
                            }
                        });
                    });
                }

            });
            mapChart.on('click', function (params) {
                if (UserList.CountyId == 0 && UserList.CityId == 0) {
                    LoadRegion(params.data.name, 29, params.data.ID, 0);
                    GetList(params.data.ID, 0);
                    $("#main3").hide();
                    $("#citymap").css("display", "inline-block");
                    LoadCityMap(params.data.ID, params.data.name);
                }
            });
        }
        function OverloadMap(MapChart, Data) {
            var MaxCount = 0;
            var MinCount = 99999999;
            $(Data).each(function () {
                if (parseInt(this.value) > MaxCount) {
                    MaxCount = parseInt(this.value);
                }
                if (parseInt(this.value) < MinCount) {
                    MinCount = parseInt(this.value);
                }
            });
            var option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}<br/>{c}'
                },

                visualMap: {
                    min: MinCount,
                    max: MaxCount,
                    text: ['High', 'Low'],
                    realtime: false,
                    calculable: true,
                    inRange: {
                        color: ['lightskyblue', 'yellow', 'orangered']
                    }
                },
                series: [
                    {
                        name: '青海省扶贫分布',
                        type: 'map',
                        mapType: 'qinghai', // 自定义扩展图表类型
                        itemStyle: {
                            normal: { label: { show: true } },
                            emphasis: { label: { show: true } }
                        },
                        data: Data
                    }
                ]
            };
            MapChart.setOption(option);

        }
        function LoadCityMap(CityId, CityName) {
            var jsonname = GetJsonName(CityName);
            var mapChart = echarts.init(document.getElementById('citymap'));
            $.get("/js/" + jsonname + ".json", function (geoJson) {
                echarts.registerMap(jsonname, geoJson);
            });
            var MapData = [];
            $.post(ServiceUrl + "CountyInterface/GetHandler.ashx", { CityId: CityId }, function (res) {
                var json = JSON.parse(res);
                if (json.Result) {
                    $(json.Data).each(function () {
                        var CountyID = this.ID;
                        var CountyName = this.Name;
                        $.post(ServiceUrl + "PovertyArchivesInterface/GetHandler.ashx", { CountyID: CountyID }, function (res1) {
                            var cityjson = JSON.parse(res1);
                            if (cityjson.Result) {
                                var Count = 0;
                                $(cityjson.Data).each(function () {
                                    Count += parseInt(this.ID);
                                });
                                MapData.push({
                                    name: CountyName,
                                    value: Count,
                                    ID: CountyID
                                });
                                OverloadCityMap(jsonname, mapChart, MapData, CityName);
                            }

                        });
                    });
                }

            });
            mapChart.on('click', function (params) {
                if (UserList.CountyId == 0 && UserList.CityId == 0) {
                    $("#citymap").hide();
                    $("#main3").css("display", "inline-block")
                    LoadRegion("青海省", 29, 0, 0);
                    GetList(0, 0);
                }
            });
        }
        function GetJsonName(Name) {
            var jsonname = "";
            switch (Name) {
                case "西宁市":
                    jsonname = "XiNing";
                    break;
                case "海东市":
                    jsonname = "HaiDong";
                    break;
                case "海北藏族自治州":
                    jsonname = "HaiBei";
                    break;
                case "黄南藏族自治州":
                    jsonname = "HuangNan";
                    break;
                case "海南藏族自治州":
                    jsonname = "HaiNan";
                    break;
                case "果洛藏族自治州":
                    jsonname = "GuoLuo";
                    break;
                case "玉树藏族自治州":
                    jsonname = "YuShu";
                    break;
                case "海西蒙古族藏族自治州":
                    jsonname = "HaiXi";
                    break;
            }
            return jsonname;

        }
        function OverloadCityMap(jsonName, MapChart, Data, CityName) {
            var MaxCount = 0;
            var MinCount = 99999999;
            $(Data).each(function () {
                if (parseInt(this.value) > MaxCount) {
                    MaxCount = parseInt(this.value);
                }
                if (parseInt(this.value) < MinCount) {
                    MinCount = parseInt(this.value);
                }
            });
            MapChart.setOption(option = {
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}<br/>{c}'
                },

                visualMap: {
                    min: MinCount,
                    max: MaxCount,
                    text: ['High', 'Low'],
                    realtime: false,
                    calculable: true,
                    inRange: {
                        color: ['lightskyblue', 'yellow', 'orangered']
                    }
                },
                series: [
                    {
                        name: CityName + '扶贫分布',
                        type: 'map',
                        mapType: jsonName, // 自定义扩展图表类型
                        itemStyle: {
                            normal: { label: { show: true } },
                            emphasis: { label: { show: true } }
                        },
                        data: Data
                    }
                ]
            });
        }
        function LoadRegion(PlaceName, ProvinceId, CityId, CountyId) {
            $(".Place_name").text(PlaceName);
            $("<a>").appendTo($(".Place_name")).attr("href", "../poverty/pager.html?ProvinceId=" + ProvinceId + "&CountyId=" + CountyId + "&CityId=" + CityId + "&PlaceName=" + escape(PlaceName)).text("点击进入");
            $.post(ServiceUrl + "PovertyArchivesInterface/GetHandler.ashx", { ProvinceID: ProvinceId, CityID: CityId, CountyID: CountyId, StudentStatus: 1 }, function (data) {
                var result = JSON.parse(data);
                if (result.Result) {
                    var PovertyCount = 0;
                    var NotPovertyCount = 0;
                    $(result.Data).each(function () {
                        if (this.PovertyStates == "0") {
                            PovertyCount += parseInt(this.ID);
                        }
                        else {
                            NotPovertyCount += parseInt(this.ID);
                        }
                    });
                    var SumCount = parseFloat(PovertyCount) + parseFloat(NotPovertyCount);
                    $(".palce_InSchoolSumCount").text(SumCount + "人");
                }
            });
            $.post(ServiceUrl + "PovertyArchivesInterface/GetByHouseHandler.ashx", { ProvinceID: ProvinceId, CityID: CityId, CountyID: CountyId, Count: 1 }, function (data) {
                var result = JSON.parse(data);
                if (result.Result) {
                    var PovertyCount = 0;
                    var NotPovertyCount = 0;
                    if (result.Data.length > 0) {
                        $(".palce_HouseSumCount").text(result.Data[0].ID + "户");
                    }
                    else {
                        $(".palce_HouseSumCount").text("0户");
                    }
                }
            });

            $.post(ServiceUrl + "PovertyArchivesInterface/GetHandler.ashx", { ProvinceID: ProvinceId, CityID: CityId, CountyID: CountyId }, function (data) {
                var result = JSON.parse(data);
                if (result.Result) {
                    var PovertyCount = 0;
                    var NotPovertyCount = 0;
                    $(result.Data).each(function () {
                        if (this.PovertyStates == "0") {
                            PovertyCount += parseInt(this.ID);
                        }
                        else {
                            NotPovertyCount += parseInt(this.ID);
                        }
                    });
                    var SumCount = parseFloat(PovertyCount) + parseFloat(NotPovertyCount);
                    $(".palce_SumCount").text(SumCount + "人");

                    var PovertyRebate = 0;
                    var NotPovertyRebate = 0;
                    if (SumCount > 0) {
                        PovertyRebate = parseFloat(PovertyCount / SumCount * 100).toFixed(2);
                        NotPovertyRebate = parseFloat(NotPovertyCount / SumCount * 100).toFixed(2);
                    }
                    $(".palce_NotPovertyCount").text(NotPovertyCount + "人");
                    $(".palce_PovertyCount").text(PovertyCount + "人");
                    $(".palce_NotPovertyRebate").text(NotPovertyRebate.toString().replace(".00", "") + "%");
                    $(".palce_PovertyRebate").text(PovertyRebate.toString().replace(".00", "") + "%");
                    var ageCnt = 0;
                    var option = {
                        tooltip: {
                            trigger: 'item',
                            formatter: "{a} <br/>{b} : {c}人 ({d}%)"
                        },
                        //legend: {
                        //    orient: 'horizontal',
                        //    x: 'left',
                        //    data: ['0-3岁', '4-18岁', '19-25岁', '26-59岁', '60岁以上','未知年龄']
                        //},
                        color: ["#01a8df", "#0180cf", "#01d6de", "#01cfa8", "#8bd16e", "#009944"],
                        normal: {
                            // 阴影的大小
                            shadowBlur: 0,
                            // 阴影水平方向上的偏移
                            shadowOffsetX: 0,
                            // 阴影垂直方向上的偏移
                            shadowOffsetY: 0,
                            // 阴影颜色
                            shadowColor: 'rgba(0, 0, 0, 0.5)'
                        },
                        series: [
                            {
                                name: '年龄分布',
                                type: 'pie',
                                radius: '55%',
                                data: [{ name: "未知年龄", value: 0 }]
                            }
                        ]
                    };
                    var chartData = [];
                    var myChart = echarts.init(document.getElementById('AgeChart'));
                    var area = "Province", areaid = ProvinceId;
                    if (CityId != 0) {
                        area = "City";
                        areaid = CityId;
                    }
                    if (CountyId != 0) {
                        area = "County";
                        areaid = CountyId;
                    }

                    $("span[data-min][data-max]").each(function () {
                        $(this).text("统计中...");
                        var This = this;
                        var minAge = $(This).attr("data-min"), maxAge = $(this).attr("data-max");
                        $.post(ServiceUrl + "PovertyArchivesInterface/CountByAgeHandler.ashx", { "MinAge": minAge, "MaxAge": maxAge, "Area": area, "AreaId": areaid }, function (json) {
                            if (json.Result) {
                                $(This).text(json.Data[0].Count + "人");
                                ageCnt += json.Data[0].Count;
                                chartData.push({ value: json.Data[0].Count, name: minAge + "-" + maxAge + "岁" });
                                option.series[0].data.push({ value: json.Data[0].Count, name: minAge + "-" + maxAge + "岁" });
                                myChart.setOption(option);
                            }
                            $("#NoAge").text(SumCount - ageCnt + "人");
                            option.series[0].data[0].value = SumCount - ageCnt ;
                            myChart.setOption(option);
                        });
                    });
                }
            });
        }
        function LoadPie(dom, color, data) {
            var myChart2 = echarts.init(dom);
            //	app.title = '环形图';

            option = {
                tooltip: {
                    show: false,
                    trigger: 'axis'
                    //formatter: "{a} <br/>{b}: {c} ({d}%)"
                },
                legend: {
                    orient: 'vertical',
                    x: 'left',
                },
                color: color,
                series: [
                    {
                        name: '',
                        type: 'pie',
                        radius: ['50%', '70%'],
                        avoidLabelOverlap: false,
                        label: {
                            normal: {
                                show: false,
                                position: 'center'
                            },
                            emphasis: {
                                show: false
                            }
                        },
                        labelLine: {
                            normal: {
                                show: false
                            }
                        },
                        data: data
                    }
                ]
            };
            myChart2.setOption(option);
        }
        function GetList(CityId, CountyId) {
            $("#box").empty();
            if (CountyId != 0) {
                $.post(ServiceUrl + "CountrysideInterface/GetHandler.ashx", { CountyID: CountyId }, function (data) {
                    var result = JSON.parse(data);
                    if (result.Result) {
                        var data = [];
                        $(result.Data).each(function () {
                            data.push({
                                name: this.Name,
                                CityId: CityId,
                                CountyId: CountyId,
                                CountrySideId: this.ID
                            });
                        });
                        loadlistbydata(data);
                    }
                });
            }
            else if (CountyId == 0 && CityId != 0) {
                $.post(ServiceUrl + "CountyInterface/GetHandler.ashx", { CityID: CityId }, function (data) {
                    var result = JSON.parse(data);
                    if (result.Result) {
                        var data = [];
                        $(result.Data).each(function () {
                            data.push({
                                name: this.Name,
                                CityId: CityId,
                                CountyId: this.ID,
                                CountrySideId: 0
                            });
                        });
                        loadlistbydata(data);
                    }
                });
            }
            else {
                $.post(ServiceUrl + "CityInterface/GetHandler.ashx", { ProvinceID: 29 }, function (data) {
                    var result = JSON.parse(data);
                    if (result.Result) {
                        var data = [];
                        $(result.Data).each(function () {
                            data.push({
                                name: this.Name,
                                CityId: this.ID,
                                CountyId: 0,
                                CountrySideId: 0
                            });
                        });
                        loadlistbydata(data);
                    }
                });
            }
        }
        function loadlistbydata(data) {
            var piecount = 3;
            $(data).each(function () {
                var name = this.name;
                var thiscityid = this.CityId;
                var thiscountyid = this.CountyId;
                var thiscountrysideid = this.CountrySideId;
                $.post(ServiceUrl + "PovertyArchivesInterface/GetHandler.ashx", { ProvinceID: 29, CityID: this.CityId, CountyID: this.CountyId, CountrySideID: this.CountrySideId }, function (res) {
                    var result = JSON.parse(res);
                    if (result.Result) {
                        var povertyCount = 0;
                        var OutPovertyCount = 0;
                        $(result.Data).each(function () {
                            if (this.PovertyStates == "0") {
                                povertyCount += parseInt(this.ID);
                            }
                            else {
                                OutPovertyCount += parseInt(this.ID);
                            }
                        });
                        var sumcount = parseInt(OutPovertyCount) + parseInt(povertyCount);
                       
                      
                        var data_con_box = $("<div>").appendTo($("#box")).addClass("cont_box");
                        
                        var middle = $("<div>").appendTo(data_con_box).addClass("middle");
                        var RegionName = $("<h1>").appendTo(middle).addClass("title");
                        $("<text>").appendTo(RegionName).text(name + " | ");
                        $("<span>").appendTo(RegionName).text("扶贫地区");
                        $("<a>").appendTo(RegionName).text("点击进入").attr("href", "../poverty/pager.html?CountrySideId=" + thiscountrysideid + "&CountyId=" + thiscountyid + "&CityId=" + thiscityid + "&PlaceName=" + escape(name)).addClass("a_search");

                        var PovertyRebate = 0;
                        var NotPovertyRebate = 0;
                        if (sumcount > 0) {
                            PovertyRebate = parseFloat(povertyCount / sumcount * 100).toFixed(2);
                            NotPovertyRebate = parseFloat(OutPovertyCount / sumcount * 100).toFixed(2);
                        }
                        var report_list = $("<div>").appendTo(middle).addClass("report_list");
                        //已复核饼图
                        var dl1 = $("<dl>").appendTo(report_list);
                        var dt1 = $("<dt>").appendTo(dl1);
                        var pie1 = $("<div>").appendTo(dt1).attr("id", "RegionChart" + piecount).css({ "width": "100%", "height": "100px" });
                        var piedata = [{ value: OutPovertyCount, name: '已复核' }, { value: povertyCount, name: '未复核' }];
                        var firstcolor = ['#3b94e1', '#e6e6e6'];
                        LoadPie(document.getElementById('RegionChart' + piecount), firstcolor, piedata);
                        piecount++;
                        $('<span>').appendTo(dt1).text(NotPovertyRebate.toString().replace(".00", "") + "%");
                        $("<dd>").appendTo(dl1).text("已复核比例");
                        //已复核人数
                        var dl2 = $("<dl>").appendTo(report_list);
                        var dt2 = $("<dt>").appendTo(dl2).addClass("iconfont").html("&#xe601;");
                        var dd2 = $("<dd>").appendTo(dl2).addClass("yituopin");
                        $("<text>").appendTo(dd2).text("已复核人数");
                        $("<span>").appendTo(dd2).text(OutPovertyCount);
                        //未复核饼图
                        var dl3 = $("<dl>").appendTo(report_list);
                        var dt3 = $("<dt>").appendTo(dl3);
                        var pie2 = $("<div>").appendTo(dt3).attr("id", "RegionChart" + piecount).css({ "width": "100%", "height": "100px" });
                        firstcolor = ['#e6e6e6', '#ff7d29'];
                        LoadPie(document.getElementById('RegionChart' + piecount), firstcolor, piedata);
                        piecount++;
                        $('<span>').appendTo(dt3).text(PovertyRebate.toString().replace(".00", "") + "%");
                        $("<dd>").appendTo(dl3).text("未复核比例");
                        //未复核人数
                        var dl4 = $("<dl>").appendTo(report_list);
                        var dt4 = $("<dt>").appendTo(dl4).addClass("iconfont").html("&#xe601;");
                        var dd4 = $("<dd>").appendTo(dl4).addClass("weituopin");
                        $("<text>").appendTo(dd4).text("未复核人数");
                        $("<span>").appendTo(dd4).text(povertyCount);
                        //地区总数
                        var dl5 = $("<dl>").appendTo(report_list);
                        var dt5 = $("<dt>").appendTo(dl5).addClass("iconfont").html("&#xe605;");
                        var dd5 = $("<dd>").appendTo(dl5).addClass("yituopin");
                        $("<text>").appendTo(dd5).text("地区总贫困人数");
                        $("<span>").appendTo(dd5).text(sumcount);

                        var age = $("<div>").appendTo(middle).addClass("report_down");
                        $("<h2>").appendTo(age).text("贫困户年龄段分布人数");
                        var ageUl = $("<ul>").appendTo($("<div>").appendTo(age));
                        var ageRange = [
                            {
                                min: 60, max: 200
                            }
                                               , {
                                                   min: 26, max: 59
                                               }
                         , {
                             min: 19, max: 25
                         }
                        , {
                            min: 4, max: 18
                        }
, {
    min: 0, max: 3
}
                        ];
                        //update by cfe 20170113 在原有的镇得基础上，增加了县这个维度 
                        var area = "City", areaid = thiscityid;
                        if (thiscountyid > 0) {
                            area = "County";
                            areaid = thiscountyid;
                        }
                        if (thiscountrysideid > 0) {
                            area = "Countryside";
                            areaid = thiscountrysideid;
                        }

                        var county = "City", countyid = thiscityid;
                        if (thiscountyid > 0) {
                            county = "County";
                            countyid = thiscountyid;
                        }
                        var countryside = "", countrysideid = thiscountrysideid;
                        if (thiscountrysideid > 0) {
                            countryside = "Countryside";
                            countrysideid = thiscountrysideid;
                        }

                        var ageCnt = 0;
                        var NoAageli = $("<li>").appendTo(ageUl);
                        $("<div>").appendTo(NoAageli).text("未知年龄");
                        $("<span>").appendTo(NoAageli).text("统计中...");
                        $(ageRange).each(function () {
                            var li = $("<li>").prependTo(ageUl);
                            var min = "0" + (this.min==0?1:this.min), max = "0" + this.max;
                            min = min.substr(min.length - 2, 2);
                            max = max.substr(max.length - 2, 2);
                            if (this.min < 60)
                                $("<div>").appendTo(li).text(min + "-" + max + "岁");
                            else
                                $("<div>").appendTo(li).text("60岁以上");
                            var span = $("<span>").appendTo(li).text("统计中...");
                            //update by cfe 20170113 在原有的镇得基础上，增加了县这个维度 
                            $.post(ServiceUrl + "PovertyArchivesInterface/CountByAgeHandler.ashx", { "MinAge": this.min, "MaxAge": this.max, "area": area, "areaID": areaid, "county": county, "countyid": countyid, "countryside": countryside, "countrysideid": countrysideid, ProvinceID: 29, CityID: this.CityId, CountyID: this.CountyId, CountrySideID: this.CountrySideId }, function (json) {
                                if (json.Result) {
                                    $(span).text(json.Data[0].Count + "人");
                                    ageCnt += json.Data[0].Count;
                                }
                                var noAgeCnt=sumcount - ageCnt;
                                $(NoAageli).children("span").text(noAgeCnt + "人");
                            });
                        }); 
                    }
                });
            });

        }

    </script>


</body>
</html>